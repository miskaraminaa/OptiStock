"use strict";(self.webpackChunkadmin_dashboard_template_OptiStock=self.webpackChunkadmin_dashboard_template_OptiStock||[]).push([[77],{2782:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(3547),l=a(184);const s=function(e){let{title:t,children:a,topMargin:s,TopSideButtons:o}=e;return(0,l.jsxs)("div",{className:"card w-full p-6 bg-base-100 shadow-xl "+(s||"mt-6"),children:[(0,l.jsxs)(n.Z,{styleClass:o?"inline-block":"",children:[t,o&&(0,l.jsx)("div",{className:"inline-block float-right",children:o})]}),(0,l.jsx)("div",{className:"divider mt-2"}),(0,l.jsx)("div",{className:"h-full w-full pb-6 bg-base-100",children:a})]})}},3547:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(184);const l=function(e){let{styleClass:t,children:a}=e;return(0,n.jsx)("div",{className:"text-xl font-semibold ".concat(t),children:a})}},3077:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var n=a(2791),l=a(9434),s=a(5054),o=a(1413),r=a(2782),i=a(8060),c=a(9313),d=a(3158),u=a(2426),m=a.n(u),p=a(4045),h=a(184);const y=()=>{const e=(0,l.I0)(),[t,a]=(0,n.useState)([]),[s,u]=(0,n.useState)(""),[y,_]=(0,n.useState)("LE"),[f,x]=(0,n.useState)([]),[b,g]=(0,n.useState)([]),[k,v]=(0,n.useState)({status:"",deliveryCode:"",articleCode:""}),[j,N]=(0,n.useState)(new Set),[S,E]=(0,n.useState)(!1),[V,w]=(0,n.useState)(null),L="http://localhost:5000";(0,n.useEffect)((()=>{y&&(async()=>{E(!0),w(null),a([]),u("");const e="".concat(L,"/livraison/files");console.log("Fetching files from: ".concat(e," with type: ").concat(y));try{const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:y})});if(console.log("Response status: ".concat(t.status,", URL: ").concat(e)),!t.ok){const e=await t.text();throw new Error("HTTP error! status: ".concat(t.status,", message: ").concat(e))}const n=await t.json();console.log("Received files:",n.files),a(n.files||[]),E(!1),0===n.files.length&&w("No files available for type ".concat(y,"."))}catch(t){console.error("Error fetching files:",t),w("Failed to load file names: ".concat(t.message)),E(!1)}})()}),[L,y]),(0,n.useEffect)((()=>{s&&y?(async()=>{w(null);const e="".concat(L,"/livraison/process"),t={type:y,fileName:s,value:k.articleCode||"",stock:k.status||"Tous les statuts"};console.log("Fetching data from: ".concat(e," with payload:"),t);try{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("Response status: ".concat(a.status,", URL: ").concat(e)),!a.ok){const e=await a.text();throw new Error("HTTP error! status: ".concat(a.status,", message: ").concat(e))}const n=await a.json();console.log("Received data:",n),x(n),g(n)}catch(a){console.error("Error fetching data:",a),w("Failed to load data for selected file: ".concat(a.message))}})():(x([]),g([]),!s&&y&&w("Please select a file to load data."))}),[s,k,L,y]);const T=t=>{if("add"===t)e((0,i.h7)({title:"Ajouter un nouvel article",bodyType:c.MODAL_BODY_TYPES.FORM,extraObject:{fields:"LE"===y?[{name:"Document",type:"text",defaultValue:"LIV".concat(m()().format("YYYYMMDDHHmmss")),required:!0},{name:"Produit",type:"text",defaultValue:"ART001",required:!0},{name:"designation_article",type:"text",defaultValue:"New Item"},{name:"famille",type:"text",defaultValue:"Default"},{name:"libelle_produit",type:"text",defaultValue:"Default Product"},{name:"Plant_Storage",type:"text",defaultValue:"Plant 1-Loc 1"},{name:"emplacement_cedant",type:"text",defaultValue:"Loc 2"},{name:"Emplacement_prenant",type:"text",defaultValue:"Loc 1"},{name:"Emplacement_EWM_Qte",type:"text",defaultValue:"Loc 1/100"},{name:"Qte_theo_ced_UQA",type:"number",defaultValue:"100",required:!0},{name:"quantit",type:"number",defaultValue:"95",required:!0},{name:"quantite_ecart",type:"number",defaultValue:"5"},{name:"Statut_tache_magasin",type:"select",options:["Non termin\xe9e","Termin\xe9e"],defaultValue:"Non termin\xe9e"},{name:"statut_entree_stock",type:"select",options:["Non termin\xe9e","Termin\xe9e"],defaultValue:"Non termin\xe9e"},{name:"longueur",type:"number",defaultValue:"100"},{name:"largeur",type:"number",defaultValue:"50"},{name:"hauteur",type:"number",defaultValue:"20"},{name:"volume",type:"number",defaultValue:"100000"},{name:"poids",type:"number",defaultValue:"10"},{name:"Quantite",type:"number",defaultValue:"100"},{name:"poids_global",type:"number",defaultValue:"1000"},{name:"volume_quantite",type:"number",defaultValue:"1000"},{name:"manutention",type:"text",defaultValue:"Manual"},{name:"Type_Rayon",type:"text",defaultValue:"Standard"}]:[{name:"Document",type:"text",defaultValue:"LIV".concat(m()().format("YYYYMMDDHHmmss")),required:!0},{name:"Produit",type:"text",defaultValue:"ART001",required:!0},{name:"designation_article",type:"text",defaultValue:"New Item"},{name:"famille",type:"text",defaultValue:"Default"},{name:"libelle_produit",type:"text",defaultValue:"Default Product"},{name:"Plant_Storage",type:"text",defaultValue:"Plant 1-Loc 1"},{name:"Emplacement_cedant",type:"text",defaultValue:"Loc 2"},{name:"Emplacement_prenant",type:"text",defaultValue:"Loc 1"},{name:"Emplacement_EWM_Qte",type:"text",defaultValue:"Loc 1/100"},{name:"Qte_theo_ced_UQA",type:"number",defaultValue:"100",required:!0},{name:"quantit",type:"number",defaultValue:"95",required:!0},{name:"quantite_ecart",type:"number",defaultValue:"5"},{name:"Statut_tache_magasin",type:"select",options:["Non termin\xe9e","Termin\xe9e"],defaultValue:"Non termin\xe9e"},{name:"statut_entree_stock",type:"select",options:["Non termin\xe9e","Termin\xe9e"],defaultValue:"Non termin\xe9e"}],onSubmit:e=>{const t=[...b];e.Qte_theo_ced_UQA&&e.quantit&&(e.quantite_ecart=(parseFloat(e.Qte_theo_ced_UQA)-parseFloat(e.quantit)).toString()),t.push(e),g(t)}}}));else if("remove"===t&&j.size>0){const e=[...b];Array.from(j).sort(((e,t)=>t-e)).forEach((t=>e.splice(t,1))),N(new Set),g(e)}},C="LE"===y?[{header:"N\xb0 LE",key:"Document"},{header:"Statut_tache_magasin",key:"Statut_tache_magasin"},{header:"Produit",key:"Produit"},{header:"designation_article",key:"designation_article"},{header:"Famille",key:"famille"},{header:"libelle_produit",key:"libelle_produit"},{header:"Longueur",key:"longueur"},{header:"Largeur",key:"largeur"},{header:"Hauteur",key:"hauteur"},{header:"Volume",key:"volume"},{header:"Poids",key:"poids"},{header:"Quantit\xe9",key:"Quantite"},{header:"Poids Global",key:"poids_global"},{header:"Volume/Quantit\xe9",key:"volume_quantite"},{header:"Manutention",key:"manutention"},{header:"Type Rayon",key:"Type_Rayon"},{header:"Plant-SLC",key:"Plant_Storage"},{header:"emplacement_c\xe9dant",key:"emplacement_cedant"},{header:"Emplacement_prenant",key:"Emplacement_prenant"},{header:"Emplacement_Final_EWM/Qte",key:"Emplacement_EWM_Qte",style:{width:"200px"}},{header:"Qte_Th\xe9o_c\xe9d_UQA",key:"Qte_theo_ced_UQA"},{header:"Quantit\xe9 Entrante",key:"quantit"},{header:"Qt\xe9 \xe9cart",key:"quantite_ecart"},{header:"statut_entree_stock",key:"statut_entree_stock"}]:[{header:"N\xb0 LS",key:"Document"},{header:"Statut",key:"Statut_tache_magasin"},{header:"Produit",key:"Produit"},{header:"Designation",key:"designation_article"},{header:"Famille",key:"famille"},{header:"libelle_produit",key:"libelle_produit"},{header:"Plant-SLC",key:"Plant_Storage"},{header:"emplacement_c\xe9dant",key:"Emplacement_cedant"},{header:"Emplacement_prenant",key:"Emplacement_prenant"},{header:"Emplacement_EWM/Qte",key:"Emplacement_EWM_Qte"},{header:"Qte_Th\xe9o_c\xe9d_UQA",key:"Qte_theo_ced_UQA"},{header:"quantit\xe9",key:"quantit"},{header:"qt\xe9 \xe9cart",key:"quantite_ecart"},{header:"statut_entree_stock",key:"statut_entree_stock"}];return(0,h.jsx)(r.Z,{title:"Livraison",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,h.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,h.jsxs)("select",{value:y,onChange:e=>{_(e.target.value),u(""),a([]),w(null)},className:"p-2 border rounded",children:[(0,h.jsx)("option",{value:"LE",children:"Livraison Entrante (LE)"}),(0,h.jsx)("option",{value:"LS",children:"Livraison Sortante (LS)"})]}),(0,h.jsxs)("select",{value:s,onChange:e=>{u(e.target.value),w(null)},className:"p-2 border rounded",disabled:S,children:[(0,h.jsx)("option",{value:"",children:S?"Loading files...":"Select a file"}),t.map((e=>(0,h.jsx)("option",{value:e,children:e},e)))]}),(0,h.jsxs)("select",{value:k.status,onChange:e=>v((0,o.Z)((0,o.Z)({},k),{},{status:e.target.value})),className:"p-2 border rounded",children:[(0,h.jsx)("option",{value:"Tous les statuts",children:"Tous les statuts"}),(0,h.jsx)("option",{value:"Termin\xe9e",children:"Termin\xe9e"}),(0,h.jsx)("option",{value:"Non termin\xe9e",children:"Non termin\xe9e"})]}),(0,h.jsx)("input",{type:"text",placeholder:"Code article",value:k.articleCode,onChange:e=>v((0,o.Z)((0,o.Z)({},k),{},{articleCode:e.target.value})),className:"p-2 border rounded"})]}),V&&(0,h.jsx)("div",{className:"text-red-500 mb-4",children:V}),(0,h.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,h.jsx)("button",{onClick:()=>T("add"),className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600",disabled:!s,children:"Ajouter"}),(0,h.jsx)("button",{onClick:()=>T("remove"),className:"bg-red-500 text-white p-2 rounded hover:bg-red-600",disabled:0===j.size,children:"Retirer"}),(0,h.jsx)("button",{onClick:()=>{const e=p.P6.json_to_sheet(b),t=p.P6.book_new();p.P6.book_append_sheet(t,e,"Livraisons"),p.NC(t,"livraison_".concat(m()().format("YYYYMMDD_HHmmss"),".xlsx"))},className:"bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"Exporter Excel"}),(0,h.jsx)("button",{onClick:()=>{const e=document.getElementById("livraison-table").outerHTML,t=window.open("","_blank");t.document.write("\n            <html>\n                <head><title>Print Livraison</title></head>\n                <body>".concat(e,"</body>\n            </html>\n        ")),t.document.close(),t.print()},className:"bg-yellow-500 text-white p-2 rounded hover:bg-yellow-600",children:"Imprimer"})]}),(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)("table",{id:"livraison-table",className:"w-full text-sm text-left text-gray-500",children:[(0,h.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-2",children:(0,h.jsx)("input",{type:"checkbox",onChange:e=>N(e.target.checked?new Set(b.map(((e,t)=>t))):new Set)})}),C.map((e=>(0,h.jsx)("th",{className:"px-4 py-2",style:e.style||{},children:e.header},e.key))),(0,h.jsx)("th",{className:"px-4 py-2",children:"Actions"})]})}),(0,h.jsx)("tbody",{children:b.map(((t,a)=>(0,h.jsxs)("tr",{className:"".concat(j.has(a)?"bg-gray-100":""," border-b hover:bg-gray-50"),children:[(0,h.jsx)("td",{className:"px-4 py-2",children:(0,h.jsx)("input",{type:"checkbox",checked:j.has(a),onChange:()=>(e=>{const t=new Set(j);t.has(e)?t.delete(e):t.add(e),N(t)})(a)})}),C.map((e=>(0,h.jsx)("td",{className:"px-4 py-2",style:e.style||{},children:t[e.key]||""},e.key))),(0,h.jsx)("td",{className:"px-4 py-2",children:(0,h.jsx)("button",{onClick:()=>(t=>{e((0,i.h7)({title:"Confirm Deletion",bodyType:c.MODAL_BODY_TYPES.CONFIRMATION,extraObject:{index:t},onClose:e=>{let{closeType:a}=e;if(a===c.CONFIRMATION_MODAL_CLOSE_TYPES.PRIMARY){const e=[...b];e.splice(t,1),g(e),N(new Set)}}}))})(a),className:"text-red-500 hover:text-red-700",children:(0,h.jsx)(d.Z,{className:"h-5 w-5"})})})]},a)))})]})})]})})};const _=function(){const e=(0,l.I0)();return(0,n.useEffect)((()=>{e((0,s.Iw)({title:"Leads"}))}),[]),(0,h.jsx)(y,{})}}}]);
//# sourceMappingURL=77.82599945.chunk.js.map