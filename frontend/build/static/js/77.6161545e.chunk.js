"use strict";(self.webpackChunkadmin_dashboard_template_OptiStock=self.webpackChunkadmin_dashboard_template_OptiStock||[]).push([[77],{3077:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var n=a(2791),r=a(9434),l=a(5054),o=a(1413),s=a(2782),u=a(3158),d=a(2426),c=a.n(d),i=a(4045),p=a(184);const h=()=>{(0,r.I0)();const[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[d,h]=(0,n.useState)("LE"),[m,g]=(0,n.useState)([]),[y,x]=(0,n.useState)([]),[v,b]=(0,n.useState)({status:"",deliveryCode:"",articleCode:""}),[_,j]=(0,n.useState)(new Set),[k,N]=(0,n.useState)(!1),[C,Z]=(0,n.useState)(null),[E,S]=(0,n.useState)(!1),[f,Q]=(0,n.useState)({}),w="http://localhost:5000";(0,n.useEffect)((()=>{d&&(async()=>{N(!0),Z(null),t([]),l("");const e="".concat(w,"/livraison/files");console.log("R\xe9cup\xe9ration des fichiers depuis : ".concat(e," avec le type : ").concat(d));try{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:d})});if(console.log("Statut de la r\xe9ponse : ".concat(a.status,", URL : ").concat(e)),!a.ok){const e=await a.text();throw new Error("Erreur HTTP ! statut : ".concat(a.status,", message : ").concat(e))}const n=await a.json();console.log("Fichiers re\xe7us :",n.files),t(n.files||[]),N(!1),0===n.files.length&&Z("Aucun fichier disponible pour le type ".concat(d,"."))}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers :",a),Z("\xc9chec du chargement des noms de fichiers : ".concat(a.message)),N(!1)}})()}),[w,d]),(0,n.useEffect)((()=>{a&&d?(async()=>{Z(null);const e="".concat(w,"/livraison/process"),t={type:d,fileName:a,value:v.articleCode||"",stock:v.status||"Tous les statuts"};console.log("R\xe9cup\xe9ration des donn\xe9es depuis : ".concat(e," avec les donn\xe9es :"),t);try{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("Statut de la r\xe9ponse : ".concat(a.status,", URL : ").concat(e)),!a.ok){const e=await a.text();throw new Error("Erreur HTTP ! statut : ".concat(a.status,", message : ").concat(e))}const n=await a.json();console.log("Donn\xe9es re\xe7ues :",n),g(n),x(n)}catch(n){console.error("Erreur lors de la r\xe9cup\xe9ration des donn\xe9es :",n),Z("\xc9chec du chargement des donn\xe9es pour le fichier s\xe9lectionn\xe9 : ".concat(n.message))}})():(g([]),x([]),!a&&d&&Z("Veuillez s\xe9lectionner un fichier pour charger les donn\xe9es."))}),[a,v,w,d]);const P=e=>{if("add"===e&&f){const e=(0,o.Z)((0,o.Z)({},f),{},{Document:f.Document||"LIV".concat(c()().format("YYYYMMDDHHmmss")),Statut_tache_magasin:f.Statut_tache_magasin||"Non termin\xe9e",statut_entree_stock:f.statut_entree_stock||"Non termin\xe9e"});"LE"===d&&(e.longueur=f.longueur||"100",e.largeur=f.largeur||"50",e.hauteur=f.hauteur||"20",e.volume=f.volume||"100000",e.poids=f.poids||"10",e.Quantite=f.Quantite||"100",e.poids_global=f.poids_global||"1000",e.volume_quantite=f.volume_quantite||"1000",e.manutention=f.manutention||"Manuel",e.Type_Rayon=f.Type_Rayon||"Standard"),f.Qte_theo_ced_UQA&&f.quantit&&(e.quantite_ecart=(parseFloat(f.Qte_theo_ced_UQA)-parseFloat(f.quantit)).toString());const t=[...y,e];x(t),S(!1),Q({})}else if("remove"===e&&_.size>0){const e=[...y];Array.from(_).sort(((e,t)=>t-e)).forEach((t=>e.splice(t,1))),j(new Set),x(e)}},L="LE"===d?[{header:"N\xb0 LE",key:"Document"},{header:"Statut T\xe2che Magasin",key:"Statut_tache_magasin"},{header:"Produit",key:"Produit"},{header:"D\xe9signation Article",key:"designation_article"},{header:"Famille",key:"famille"},{header:"Libell\xe9 Produit",key:"libelle_produit"},{header:"Longueur",key:"longueur"},{header:"Largeur",key:"largeur"},{header:"Hauteur",key:"hauteur"},{header:"Volume",key:"volume"},{header:"Poids",key:"poids"},{header:"Quantit\xe9",key:"Quantite"},{header:"Poids Global",key:"poids_global"},{header:"Volume/Quantit\xe9",key:"volume_quantite"},{header:"Manutention",key:"manutention"},{header:"Type Rayon",key:"Type_Rayon"},{header:"Plant-SLC",key:"Plant_Storage"},{header:"Emplacement C\xe9dant",key:"emplacement_cedant"},{header:"Emplacement Prenant",key:"Emplacement_prenant"},{header:"Emplacement Final EWM/Qte",key:"Emplacement_EWM_Qte",style:{width:"200px"}},{header:"Qte Th\xe9o C\xe9d UQA",key:"Qte_theo_ced_UQA"},{header:"Quantit\xe9 Entrante",key:"quantit"},{header:"Qt\xe9 \xc9cart",key:"quantite_ecart"},{header:"Statut Activit\xe9 Magasin",key:"statut_entree_stock"}]:[{header:"N\xb0 LS",key:"Document"},{header:"Statut",key:"Statut_tache_magasin"},{header:"Produit",key:"Produit"},{header:"D\xe9signation",key:"designation_article"},{header:"Famille",key:"famille"},{header:"Libell\xe9 Produit",key:"libelle_produit"},{header:"Plant-SLC",key:"Plant_Storage"},{header:"Emplacement C\xe9dant",key:"Emplacement_cedant"},{header:"Emplacement Prenant",key:"Emplacement_prenant"},{header:"Emplacement EWM/Qte",key:"Emplacement_EWM_Qte"},{header:"Qte Th\xe9o C\xe9d UQA",key:"Qte_theo_ced_UQA"},{header:"Quantit\xe9",key:"quantit"},{header:"Qt\xe9 \xc9cart",key:"quantite_ecart"},{header:"Statut Activit\xe9 Magasin",key:"statut_entree_stock"}];return(0,p.jsx)(s.Z,{title:"Livraison",children:(0,p.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,p.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,p.jsxs)("select",{value:d,onChange:e=>{h(e.target.value),l(""),t([]),Z(null),S(!1),Q({})},className:"p-2 border rounded",children:[(0,p.jsx)("option",{value:"LE",children:"Livraison Entrante (LE)"}),(0,p.jsx)("option",{value:"LS",children:"Livraison Sortante (LS)"})]}),(0,p.jsxs)("select",{value:a,onChange:e=>{l(e.target.value),Z(null),S(!1),Q({})},className:"p-2 border rounded",disabled:k,children:[(0,p.jsx)("option",{value:"",children:k?"Chargement des fichiers...":"S\xe9lectionner un fichier"}),e.map((e=>(0,p.jsx)("option",{value:e,children:e},e)))]}),(0,p.jsxs)("select",{value:v.status,onChange:e=>b((0,o.Z)((0,o.Z)({},v),{},{status:e.target.value})),className:"p-2 border rounded",children:[(0,p.jsx)("option",{value:"Tous les statuts",children:"Tous les statuts"}),(0,p.jsx)("option",{value:"Termin\xe9e",children:"Termin\xe9e"}),(0,p.jsx)("option",{value:"Non termin\xe9e",children:"Non termin\xe9e"})]}),(0,p.jsx)("input",{type:"text",placeholder:"Code article",value:v.articleCode,onChange:e=>b((0,o.Z)((0,o.Z)({},v),{},{articleCode:e.target.value})),className:"p-2 border rounded"})]}),C&&(0,p.jsx)("div",{className:"text-red-500 mb-4",children:C}),(0,p.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,p.jsx)("button",{onClick:()=>S(!E),className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600",disabled:!a,children:E?"Annuler":"Ajouter"}),(0,p.jsx)("button",{onClick:()=>P("remove"),className:"bg-red-500 text-white p-2 rounded hover:bg-red-600",disabled:0===_.size,children:"Retirer"}),(0,p.jsx)("button",{onClick:()=>{const e=i.P6.json_to_sheet(y),t=i.P6.book_new();i.P6.book_append_sheet(t,e,"Livraisons"),i.NC(t,"livraison_".concat(c()().format("YYYYMMDD_HHmmss"),".xlsx"))},className:"bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"Exporter Excel"}),(0,p.jsx)("button",{onClick:()=>{const e=document.getElementById("livraison-table").outerHTML,t=window.open("","_blank");t.document.write("\n            <html>\n                <head><title>Imprimer Livraison</title></head>\n                <body>".concat(e,"</body>\n            </html>\n        ")),t.document.close(),t.print()},className:"bg-yellow-500 text-white p-2 rounded hover:bg-yellow-600",children:"Imprimer"})]}),E&&(0,p.jsxs)("div",{className:"mb-4 p-4 border rounded bg-gray-50",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Ajouter un nouvel article"}),(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),P("add")},className:"grid grid-cols-2 gap-4",children:[(0,p.jsx)("input",{type:"text",placeholder:"Document",value:f.Document||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Document:e.target.value})),className:"p-2 border rounded",required:!0}),(0,p.jsx)("input",{type:"text",placeholder:"Produit",value:f.Produit||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Produit:e.target.value})),className:"p-2 border rounded",required:!0}),(0,p.jsx)("input",{type:"text",placeholder:"D\xe9signation Article",value:f.designation_article||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{designation_article:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Famille",value:f.famille||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{famille:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Libell\xe9 Produit",value:f.libelle_produit||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{libelle_produit:e.target.value})),className:"p-2 border rounded"}),"LE"===d&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("input",{type:"number",placeholder:"Longueur",value:f.longueur||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{longueur:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Largeur",value:f.largeur||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{largeur:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Hauteur",value:f.hauteur||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{hauteur:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Volume",value:f.volume||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{volume:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Poids",value:f.poids||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{poids:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Quantit\xe9",value:f.Quantite||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Quantite:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Poids Global",value:f.poids_global||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{poids_global:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Volume/Quantit\xe9",value:f.volume_quantite||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{volume_quantite:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Manutention",value:f.manutention||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{manutention:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Type Rayon",value:f.Type_Rayon||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Type_Rayon:e.target.value})),className:"p-2 border rounded"})]}),(0,p.jsx)("input",{type:"text",placeholder:"Plant_Storage",value:f.Plant_Storage||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Plant_Storage:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Emplacement C\xe9dant",value:f.emplacement_cedant||f.Emplacement_cedant||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{["LE"===d?"emplacement_cedant":"Emplacement_cedant"]:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Emplacement Prenant",value:f.Emplacement_prenant||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Emplacement_prenant:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"text",placeholder:"Emplacement EWM/Qte",value:f.Emplacement_EWM_Qte||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Emplacement_EWM_Qte:e.target.value})),className:"p-2 border rounded"}),(0,p.jsx)("input",{type:"number",placeholder:"Qte Th\xe9o C\xe9d UQA",value:f.Qte_theo_ced_UQA||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Qte_theo_ced_UQA:e.target.value})),className:"p-2 border rounded",required:!0}),(0,p.jsx)("input",{type:"number",placeholder:"Quantit\xe9",value:f.quantit||"",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{quantit:e.target.value})),className:"p-2 border rounded",required:!0}),(0,p.jsx)("input",{type:"text",placeholder:"Qt\xe9 \xc9cart",value:f.quantite_ecart||"",readOnly:!0,className:"p-2 border rounded bg-gray-100"}),(0,p.jsxs)("select",{value:f.Statut_tache_magasin||"Non termin\xe9e",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{Statut_tache_magasin:e.target.value})),className:"p-2 border rounded",children:[(0,p.jsx)("option",{value:"Non termin\xe9e",children:"Non termin\xe9e"}),(0,p.jsx)("option",{value:"Termin\xe9e",children:"Termin\xe9e"})]}),(0,p.jsxs)("select",{value:f.statut_entree_stock||"Non termin\xe9e",onChange:e=>Q((0,o.Z)((0,o.Z)({},f),{},{statut_entree_stock:e.target.value})),className:"p-2 border rounded",children:[(0,p.jsx)("option",{value:"Non termin\xe9e",children:"Non termin\xe9e"}),(0,p.jsx)("option",{value:"Termin\xe9e",children:"Termin\xe9e"})]}),(0,p.jsx)("button",{type:"submit",className:"col-span-2 bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Ajouter l'article"})]})]}),(0,p.jsx)("div",{className:"overflow-x-auto",children:(0,p.jsxs)("table",{id:"livraison-table",className:"w-full text-sm text-left text-gray-500",children:[(0,p.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"px-4 py-2",children:(0,p.jsx)("input",{type:"checkbox",onChange:e=>j(e.target.checked?new Set(y.map(((e,t)=>t))):new Set)})}),L.map((e=>(0,p.jsx)("th",{className:"px-4 py-2",style:e.style||{},children:e.header},e.key))),(0,p.jsx)("th",{className:"px-4 py-2",children:"Actions"})]})}),(0,p.jsx)("tbody",{children:y.map(((e,t)=>(0,p.jsxs)("tr",{className:"".concat(_.has(t)?"bg-gray-100":""," border-b hover:bg-gray-50"),children:[(0,p.jsx)("td",{className:"px-4 py-2",children:(0,p.jsx)("input",{type:"checkbox",checked:_.has(t),onChange:()=>(e=>{const t=new Set(_);t.has(e)?t.delete(e):t.add(e),j(t)})(t)})}),L.map((t=>(0,p.jsx)("td",{className:"px-4 py-2",style:t.style||{},children:e[t.key]||""},t.key))),(0,p.jsx)("td",{className:"px-4 py-2",children:(0,p.jsx)("button",{onClick:()=>(e=>{const t=[...y];t.splice(e,1),x(t),j(new Set)})(t),className:"text-red-500 hover:text-red-700",children:(0,p.jsx)(u.Z,{className:"h-5 w-5"})})})]},t)))})]})})]})})};const m=function(){const e=(0,r.I0)();return(0,n.useEffect)((()=>{e((0,l.Iw)({title:"Leads"}))}),[]),(0,p.jsx)(h,{})}}}]);
//# sourceMappingURL=77.6161545e.chunk.js.map