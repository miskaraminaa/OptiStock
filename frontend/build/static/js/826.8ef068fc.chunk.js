"use strict";(self.webpackChunkadmin_dashboard_template_OptiStock=self.webpackChunkadmin_dashboard_template_OptiStock||[]).push([[826],{4826:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=s(1413),o=s(2791),r=s(3071),c=s(6564),n=s(184);class l extends o.Component{constructor(){super(...arguments),this.state={hasError:!1,errorMessage:""}}static getDerivedStateFromError(e){return{hasError:!0,errorMessage:e.message}}componentDidCatch(e,t){console.error("[".concat((new Date).toISOString(),"] ErrorBoundary caught an error:"),e,t)}render(){return this.state.hasError?(0,n.jsxs)("div",{className:"text-center text-red-600 p-6 bg-red-50 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Une erreur est survenue"}),(0,n.jsx)("p",{className:"text-sm",children:this.state.errorMessage||"Veuillez r\xe9essayer plus tard ou contactez le support."}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"R\xe9essayer"})]}):this.props.children}}const d=()=>{const[e,t]=(0,o.useState)([]),[s,d]=(0,o.useState)(""),[i,x]=(0,o.useState)(1),[m,h]=(0,o.useState)(1),[p,u]=(0,o.useState)(!1),[g,b]=(0,o.useState)(null),[N,S]=(0,o.useState)(!1),[f,j]=(0,o.useState)({}),y="http://localhost:5000",w=(0,o.useMemo)((()=>function(e,s){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="".concat(e||"no-search","-").concat(s);if(f[r]&&!o)return console.log("[".concat((new Date).toISOString(),"] Using cached data for ").concat(r)),t(f[r].data),h(f[r].totalPages),u(!1),void S(!1);console.log("[".concat((new Date).toISOString(),"] Fetching data for page ").concat(s,", search: ").concat(e||"none"));const c=new EventSource("".concat(y,"/rangement-le?search=").concat(encodeURIComponent(e||""),"&page=").concat(s));o||(u(!0),b(null),t([]),S(!1));const n=setTimeout((()=>{o||S(!0)}),3e3);return c.onmessage=e=>{const s=JSON.parse(e.data);if(console.log("[".concat((new Date).toISOString(),"] Received SSE event:"),s),s.error)return o||(b(s.details||"\xc9chec du chargement des donn\xe9es"),u(!1),S(!1)),c.close(),void clearTimeout(n);s.batch&&(o?j((e=>(0,a.Z)((0,a.Z)({},e),{},{[r]:{data:s.data,totalPages:s.totalPages}}))):(console.log("[".concat((new Date).toISOString(),"] Adding ").concat(s.data.length," rows to data")),t((e=>[...e,...s.data])),h(s.totalPages))),s.complete&&(o||(u(!1),S(!1)),c.close(),clearTimeout(n),console.log("[".concat((new Date).toISOString(),"] Stream complete")))},c.onerror=()=>{o||(b("Erreur de connexion au serveur. V\xe9rifiez que le serveur est en cours d\u2019ex\xe9cution."),u(!1),S(!1)),c.close(),clearTimeout(n),console.log("[".concat((new Date).toISOString(),"] SSE connection error"))},()=>c.close()}),[f]);(0,o.useEffect)((()=>{i<m&&w(s,i+1,!0)}),[i,m,s]),(0,o.useEffect)((()=>w(s,i)),[s,i]);const v=(0,o.useMemo)((()=>Array.isArray(e)&&0!==e.length?(console.log("[".concat((new Date).toISOString(),"] Rendering ").concat(e.length," rows")),e.map(((e,t)=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.article_code||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm whitespace-normal break-words",children:e.description||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",style:{whiteSpace:"pre-line"},children:e.historical_locations||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.final_location||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.suitable_location||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.Storage_Location||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.Storage_location_Valid\u00e9||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.BIN_SAP||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.quantity||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.unit||"N/A"}),(0,n.jsx)("td",{className:"py-2 px-4 border text-sm",children:e.source_file||"N/A"})]},e.article_code||"item-".concat(t))))):(console.log("[".concat((new Date).toISOString(),"] No data to display")),(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:11,className:"py-4 px-4 border text-center text-gray-500 text-sm",children:"Aucune donn\xe9e disponible"})}))),[e]);return(0,n.jsx)(l,{children:(0,n.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 max-w-full",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Guide de Rangement"}),(0,n.jsx)("div",{className:"relative mb-6",children:(0,n.jsxs)("div",{className:"flex items-center border rounded-lg bg-white shadow-sm",children:[(0,n.jsx)(r.U41,{className:"ml-3 text-gray-400"}),(0,n.jsx)("input",{type:"text",placeholder:"Rechercher par code article ou d\xe9signation",className:"w-full p-2 pl-3 border-none rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",value:s,onChange:e=>{d(e.target.value),x(1),j({}),console.log("[".concat((new Date).toISOString(),"] Search term updated: ").concat(e.target.value))},"aria-label":"Rechercher par code article ou d\xe9signation"}),s&&(0,n.jsx)("button",{onClick:()=>{d(""),x(1),j({}),console.log("[".concat((new Date).toISOString(),"] Search cleared"))},className:"p-2 text-gray-400 hover:text-gray-600","aria-label":"Effacer la recherche",children:(0,n.jsx)(r.aHS,{})})]})}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[(0,n.jsx)("button",{onClick:()=>{i>1&&(x(i-1),console.log("[".concat((new Date).toISOString(),"] Navigating to page ").concat(i-1)))},disabled:1===i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-blue-600 transition-colors text-sm","aria-label":"Page pr\xe9c\xe9dente",children:"Pr\xe9c\xe9dent"}),(0,n.jsxs)("span",{className:"text-sm text-gray-600",children:["Page ",i," sur ",m," (",e.length," enregistrements)"]}),(0,n.jsx)("button",{onClick:()=>{i<m&&(x(i+1),console.log("[".concat((new Date).toISOString(),"] Navigating to page ").concat(i+1)))},disabled:i===m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-blue-600 transition-colors text-sm","aria-label":"Page suivante",children:"Suivant"})]}),p&&(0,n.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,n.jsx)(c.Z,{size:30,color:"#3B82F6"}),(0,n.jsx)("span",{className:"ml-3 text-sm text-gray-600",children:N?"Chargement des donn\xe9es en cours, r\xe9ception des premiers r\xe9sultats...":"Chargement des donn\xe9es..."})]}),g&&(0,n.jsxs)("div",{className:"text-center text-red-600 bg-red-50 p-4 rounded-lg text-sm",children:[g,(0,n.jsx)("button",{onClick:()=>w(s,i),className:"ml-4 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"R\xe9essayer"})]}),!g&&(0,n.jsx)("div",{className:"overflow-x-auto shadow-lg rounded-lg",children:(0,n.jsxs)("table",{className:"min-w-full bg-white border text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-100 text-gray-700",children:[(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Code Article"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"D\xe9signation"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Emplacements Historiques"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Emplacement Final"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Emplacement Convenable"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Storage Location"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Storage Location Valid\xe9"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"BIN SAP"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Quantit\xe9"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Unit\xe9"}),(0,n.jsx)("th",{scope:"col",className:"py-3 px-4 border-b text-left font-medium",children:"Source Fichier"})]})}),(0,n.jsx)("tbody",{children:v})]})})]})})}}}]);
//# sourceMappingURL=826.8ef068fc.chunk.js.map